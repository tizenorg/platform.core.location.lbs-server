<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

	<!-- root can own the service -->
	<policy user="root">
		<allow own="org.tizen.lbs.Providers.LbsServer"/>

		<!-- Allow all methods on interfaces -->
		<allow send_destination="org.tizen.lbs.Providers.LbsServer"/>
		<allow receive_sender="org.tizen.lbs.Providers.LbsServer"/>
	</policy>

	<policy user="system">
		<allow own="org.tizen.lbs.Providers.LbsServer"/>
		<allow send_destination="org.tizen.lbs.Providers.LbsServer"/>
		<allow receive_sender="org.tizen.lbs.Providers.LbsServer"/>
	</policy>

	<!-- for Test
	<policy at_console="true">
		<allow own="org.tizen.lbs.Providers.LbsServer"/>
		<allow send_destination="org.tizen.lbs.Providers.LbsServer"/>
		<allow receive_sender="org.tizen.lbs.Providers.LbsServer"/>
	</policy>
	-->

	<policy context="default">
		<allow own="org.tizen.lbs.Providers.LbsServer"/>
		<allow send_destination="org.tizen.lbs.Providers.LbsServer"/>
		<allow receive_sender="org.tizen.lbs.Providers.LbsServer"/>

		<check send_destination="org.tizen.lbs.Providers.LbsServer"
			send_interface="org.tizen.lbs.Manager"
			privilege="http://tizen.org/privilege/location" />
		<check send_destination="org.tizen.lbs.Providers.LbsServer"
			send_interface="org.tizen.lbs.Position"
			privilege="http://tizen.org/privilege/location" />
		<check send_destination="org.tizen.lbs.Providers.LbsServer"
			send_interface="org.tizen.lbs.Nmea"
			privilege="http://tizen.org/privilege/location" />
		<check send_destination="org.tizen.lbs.Providers.LbsServer"
			send_interface="org.tizen.lbs.Satellite"
			privilege="http://tizen.org/privilege/location" />
		<check send_destination="org.tizen.lbs.Providers.LbsServer"
			send_interface="org.tizen.lbs.Batch"
			privilege="http://tizen.org/privilege/location" />
		<check receive_sender="org.tizen.lbs.Providers.LbsServer"
			receive_interface="org.tizen.lbs.Manager"
			privilege="http://tizen.org/privilege/location" />
		<check receive_sender="org.tizen.lbs.Providers.LbsServer"
			receive_interface="org.tizen.lbs.Position"
			privilege="http://tizen.org/privilege/location" />
		<check receive_sender="org.tizen.lbs.Providers.LbsServer"
			receive_interface="org.tizen.lbs.Position"
			privilege="http://tizen.org/privilege/location" />
		<check receive_sender="org.tizen.lbs.Providers.LbsServer"
			receive_interface="org.tizen.lbs.Nmea"
			privilege="http://tizen.org/privilege/location" />
		<check receive_sender="org.tizen.lbs.Providers.LbsServer"
			receive_interface="org.tizen.lbs.Satellite"
			privilege="http://tizen.org/privilege/location" />
		<check receive_sender="org.tizen.lbs.Providers.LbsServer"
			receive_interface="org.tizen.lbs.Batch"
			privilege="http://tizen.org/privilege/location" />

		<!-- This tag is for HW geofence
		<allow send_interface="org.tizen.lbs.Geofence"/>
		<allow receive_interface="org.tizen.lbs.Geofence"/>
		-->
	</policy>
</busconfig>
